(typeof Tumblr!=="undefined")||(Tumblr={});
Tumblr.PostMessageListener=(function(){return{initialize:function(d){d=d||function(){};var c=window.addEventListener?"addEventListener":"attachEvent";var b=window[c];var a=c=="attachEvent"?"onmessage":"message";b(a,function(g){var f=g.data.split(";");d(f,g.origin)},false)}}})();
Tumblr.Iframe=(function(){var e={},m,g,j;var h=(window.jQuery)?window.jQuery:null;var p=function(r){return document.getElementById(r)};var l=function(r){return document.querySelector(r)};var d=function(r){return document.querySelectorAll(r)};var k={};var o="http://www.tumblr.com",n="https://www.tumblr.com";if(!window.location.href.match(/^[^\/]+\/\/[^\/]+\.tumblr\.com\//i)){o=window.location.href.replace(/^([^\/]+\/\/[^\/]+).*/i,"$1");n=o}function f(u,r,t,s){if(window===window.parent){return false}if(typeof t==="undefined"){t=-1}if(typeof s==="undefined"){s=decodeURIComponent(e.origin)}return _t.delay(function(){_t.postMessage(["resize_iframe",u,r,_t.protocol_host()],s,window.parent)},t)}function b(u,r,w,x,s,v){if(!u){u=window.innerWidth}if(!r){r=window.innerHeight}if(window.innerWidth===u&&window.innerHeight===r){x.call();return false}if(w){w.call()}var t=0;return setInterval(function(){if(window.innerWidth===u&&window.innerHeight===r){return x.call()}if(v&&(++t===v)){return x.call()}},s)}function i(){if(!(e.get.name&&e.get.name.length)){return false}if(p("btn_follow_join")){p("btn_follow_join").href=n+"/register/follow/"+e.get.name}if(p("btn_follow")){p("btn_follow").href=n+"/register/follow/"+e.get.name}if(p("btn_join")){p("btn_join").href=n+"/register/join_tumblr?referring_blog="+e.get.name}}function a(s){var r={name:"mobile",pretty_name:"mobile",mobile:false};if(typeof s==="undefined"){s=(navigator.userAgent||navigator.vendor||window.opera)}if(s.match(/iphone/i)){r.name="iphone";r.pretty_name="iPhone";r.mobile=true}else{if(s.match(/ipad/i)){r.name="ipad";r.pretty_name="iPad";r.mobile=true}else{if(s.match(/android/i)||_t.is_mobile()){r.name="android";r.pretty_name="android";r.mobile=true}}}return r}function q(x,r){if(!x){return false}var v=d("[data-translation]");for(var s=v.length-1;s>=0;s--){var t=v[s],u=t.getAttribute("data-translation");if(l10n_str[g]&&l10n_str[g][u]){var w=l10n_str[g][u];if(w.indexOf("%1$s")!==-1&&e.get.name){w=w.replace("%1$s",e.get.name)}t.textContent=w;if(r){t.parentNode.setAttribute("title",l10n_str[g][u])}}}return true}var c=(function(){return{standard:function(){},pill:function(r){var s=p("iframe_controls");if(!r&&e.get.name&&e.get.name.length){p("btn_follow_join").href=n+"/register/follow/"+e.get.name;p("btn_join").href=n+"/register/join_tumblr?referring_blog="+e.get.name}_t.addClass(s,"controls_pill");_t.removeClass(document.body,"loading");Tumblr.IframeSizing.init(function(t){f(3+t,26)})},b_card:function(y){var z=p("iframe_controls");var u=p("card");i();_t.addClass(document.body,"version_pill");_t.addClass(z,"controls_pill");_t.removeClass(document.body,"loading");var s=_t.getCookie("card");if(s&&s.value==="0"){f(z.offsetWidth+1,z.offsetHeight);return}var r=e.get.name;var w=e.get.avatar;var x=e.get.title;document.getElementById("name").innerHTML=_t.sanitize(r,true);document.getElementById("avatar").style.backgroundImage="url("+_t.sanitize(w,true)+")";document.getElementById("title").innerHTML=_t.sanitize(x,true).replace(/\+/g," ");document.getElementById("card").style.display="block";if(!x){document.getElementById("name").innerHTML="";document.getElementById("title").innerHTML=_t.sanitize(r,true).replace(/\+/g," ")}var v=p("x_button");if(typeof window.addEventListener!="undefined"){v.addEventListener("click",t,false)}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onclick_x",t)}}function t(){_t.setCookie("card",0,365);if(u.parentNode){u.parentNode.removeChild(u)}f(z.offsetWidth+1,z.offsetHeight)}f(u.offsetWidth+20,u.offsetHeight+10)},bluebar:function(r,t){if(t&&!r){_t.postMessage(["mobile_iframe",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}i();var s=p("iframe_controls");_t.addClass(s,"controls_bluebar");_t.removeClass(document.body,"loading")},bar:function(r){_t.postMessage(["resize_iframe","100%",46,"body_class","top_bar",_t.protocol_host()],decodeURIComponent(e.origin),window.parent);_t.removeClass(document.body,"loading")},o_pill:function(r){var s=p("iframe_controls"),u=p("sliding_tray"),w=["follow","tumblr"];btn={},context=e.get.context||"index",timer={poll:false,postmessage:false,shimmer:false},size={margin:{top:0,right:0,bottom:0,left:0},open:{width:0,height:0,tray:0},closed:{width:0,height:0,tray:0},overshoot:0},flag={shimmer:false},fn={measure_open:function(){_t.addClass(document.body,"measuring");_t.addClass(document.body,"open");size.open.width=s.offsetWidth;size.open.height=s.offsetHeight;size.overshoot=Math.max(10,Math.ceil(0.15*size.open.width));_t.removeClass(document.body,"measuring");_t.removeClass(document.body,"open");document.body.style.minWidth=(size.open.width+size.margin.left+size.margin.right+size.overshoot)+"px";document.body.style.minHeight=(size.open.height+size.margin.top+size.margin.bottom)+"px"},measure_margins:function(y){size.margin.top=parseInt(_t.getStyle(s,"margin-top"),10);size.margin.right=parseInt(_t.getStyle(s,"margin-right"),10);size.margin.bottom=parseInt(_t.getStyle(s,"margin-bottom"),10);size.margin.left=parseInt(_t.getStyle(s,"margin-left"),10);if(typeof y==="undefined"){y=0}if(isNaN(size.margin.top)){size.margin.top=y}if(isNaN(size.margin.right)){size.margin.right=y}if(isNaN(size.margin.bottom)){size.margin.bottom=y}if(isNaN(size.margin.left)){size.margin.left=y}},shimmer:function(y){if(timer.shimmer){return true}if(y&&_t.containsElement(btn.tumblr,y.fromElement,true)){return true}_t.addClass(btn.tumblr,"shimmer");clearTimeout(timer.shimmer);timer.shimmer=_t.delay(function(){_t.removeClass(btn.tumblr,"shimmer");timer.shimmer=false},600)}};_t.each(w,function(z,y){w[z]=btn[y]=p("btn_"+y)});btn.tumblr.href=n+"/?referring_blog="+e.get.name;btn.follow.href=n+"/register/follow/"+e.get.name;var t=p("tumblelog_avatar_img");var x=p("tumblelog_avatar");var v=p("tumblelog_name");if(v){v.innerHTML=_t.sanitize(e.get.name,true)}if(t){t.src=_t.sanitize(e.get.avatar,true)}if(x){x.style.backgroundImage="url('"+_t.sanitize(e.get.avatar,true)+"')";x.href=n+"/register/follow/"+e.get.name}if(e.get.avatar==="hide"){_t.addClass(document.body,"hide_avatar")}_t.postMessage(["teaser_iframe","initialize",e.get.page_slide||"slide",_t.protocol_host()],decodeURIComponent(e.origin),window.parent);btn.tumblr.addEventListener("mouseover",function(y){if(!k.teaser){return true}_t.postMessage(["teaser_iframe","open",_t.protocol_host()],decodeURIComponent(e.origin),window.parent);if(!_t.hasClass(s,"shimmer_loop")){fn.shimmer()}});_t.delay(function(){fn.measure_margins(5);fn.measure_open();f(size.open.width+size.margin.left+size.margin.right+size.overshoot,size.open.height+size.margin.top+size.margin.bottom);_t.addClass(document.body,"animated");_t.removeClass(document.body,"loading")})},follow_nag:function(z){var A=p("iframe_controls"),t=p("sliding_tray"),y=p("x_button"),w=["follow"];btn={},timer={poll:false,postmessage:false},size={margin:{top:5,right:5,bottom:5,left:5},open:{width:300,height:99}},fn={show:function(){_t.removeClass(A,"closed")}};if(_t.getCookie("hide_follow_nag").value=="1"){return false}_t.each(w,function(D,C){w[D]=btn[C]=p("btn_"+C)});y.addEventListener("click",function(C){_t.addClass(A,"closed");_t.setCookie("hide_follow_nag",1,3);C.preventDefault();_t.postMessage(["follow_iframe","dismiss",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)});btn.follow.href=n+"/register/follow/"+e.get.name+"/2";var s=p("tumblelog_avatar_img");var r=p("tumblelog_avatar");var x=p("tumblelog_name_title");var v=p("tumblelog_name");var u=p("tumblelog_title");var B=p("tumblr_logo");if(v){v.innerHTML=decodeURIComponent(e.get.name)}if(u){u.innerHTML=decodeURIComponent((e.get.title||"").replace(/\+/g," "))||decodeURIComponent(e.get.name)}if(s){s.src=decodeURIComponent(e.get.avatar)}if(x){x.href=n+"/register/follow/"+e.get.name}if(r){r.style.backgroundImage="url('"+decodeURIComponent(e.get.avatar)+"')";r.href=n+"/register/follow/"+e.get.name}if(B){B.href=n+"/register/?referring_blog="+decodeURIComponent(e.get.name)}if(!e.get.title||e.get.title===e.get.name){_t.addClass(x,"no_title")}size.open.width=A.offsetWidth||300;size.open.height=A.offsetHeight||99;_t.addClass(A,"closed");k.follow_show=fn.show;_t.delay(function(){_t.postMessage(["follow_iframe","resize",size.open.width+size.margin.left+size.margin.right,size.open.height+size.margin.top+size.margin.bottom,_t.protocol_host()],decodeURIComponent(e.origin),window.parent);_t.removeClass(document.body,"loading")})},teaser:function(r){if(!jQuery){console.log("No jQuery? :(");return false}(function(u){var x=u("#fullscreen_post_bg"),s=u("#fullscreen_post_image"),A=u("#by_tumblelog"),w=u("#by_avatar_link"),y=u("#by_avatar"),t=u("#get_started"),v=false,z=[];current_post=false;jqXHR=false,domain=_t.getRootDomain(),root_domain="http://"+(domain.toLowerCase()!=="tumblr.com"?domain:"www.tumblr.com"),fn={prepare_next_post:function(){if(!z.length){return fn.load_posts(true)}current_post=z.shift();fn.set_post(current_post);if(!z.length){return fn.load_posts(false)}},load_posts:function(B){if(jqXHR){return}jqXHR=u.ajax({url:root_domain+"/svc/teaser",type:"GET"}).done(function(C){if(!C.length){console.log("No posts returned!");return}z=C;if(B){fn.prepare_next_post()}}).always(function(C){jqXHR=false})},set_post:function(B){u(document.body).addClass("loading");A.attr("href",B.tumblelog.url).text(B.tumblelog.name);w.attr("href",B.tumblelog.url).css("background-image","url('"+B.tumblelog.avatar+"')");y.attr({src:B.tumblelog.avatar,alt:B.tumblelog.name});x.css("background-image","url('"+B.post.media_url+"')");s.attr("src",B.post.media_url);fn.poll_show()},poll_show:function(){if(s.get(0).naturalWidth||s.get(0).naturalHeight){fn.show();v=false}else{v=setTimeout(fn.poll_show,500)}},show:function(){if(!z.length){fn.load_posts(true)}clearTimeout(v);u(document.body).removeClass("inactive waiting")},hide:function(){u(document.body).addClass("waiting")}};u(document.body).addClass("inactive");t.attr("href",root_domain+"/register/get_started?referring_blog="+decodeURIComponent(e.get.name));s.on("load",function(){u(document.body).removeClass("loading")});u(document).on("mouseleave",function(B){_t.postMessage(["teaser_iframe","close",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)});k.teaser_refresh=fn.prepare_next_post;k.teaser_show=fn.show;k.teaser_hide=fn.hide;if(window.parent!==window){fn.hide()}else{fn.show()}})(jQuery)},tagged:function(r){if(!jQuery){console.log("No jQuery? :(");return false}(function(y){var u=y("#posts"),x=y("#post_tag"),v=y("#join"),s=decodeURIComponent(e.get.tag),t=false,w=[];current_post=false;jqXHR=false,domain=_t.getRootDomain(),root_domain="http://"+(domain.toLowerCase()!=="tumblr.com"?domain:"www.tumblr.com"),fn={load_posts:function(){if(jqXHR){return}jqXHR=y.ajax({url:root_domain+"/svc/teaser/tagged",data:{tag:s},type:"GET"}).done(function(A){if(!A.length){console.log("No posts returned for "+s+"!");return}w=A;u.empty();_(w).each(function(E,D){var B=y(z(E));var C=B.find("img");C.css(fn.scale_to_height(C.data("width"),C.data("height"),124)).addClass("loading").on("load",fn.img_load);u.append(B)});_.delay(function(){y(".post img").removeClass("loading")},4000);fn.show()}).always(function(A){jqXHR=false})},img_load:function(A){_.defer(function(){y(A.currentTarget).removeClass("loading")})},scale_to_height:function(C,A,B){return{width:Math.round(C*B/A),height:B}},show:function(){_t.postMessage(["tagged_teaser_iframe","open",144,_t.protocol_host()],decodeURIComponent(e.origin),window.parent)},hide:function(){_t.postMessage(["tagged_teaser_iframe","close",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}};var z=_.template('                            <div class="post">                                <a target="_top" href="<%= post.url %>"><img src="<%= post.media_url_small %>" alt="" data-width="<%= post.media_dimensions.width %>" data-height="<%= post.media_dimensions.height %>"/></a>                            </div>                        ');y(document.body).addClass("inactive");x.attr("href",root_domain+"/tagged/"+s).text("#"+s);v.attr("href",root_domain+"/register/join_tagged?tag="+s+"&referring_blog="+decodeURIComponent(e.get.name));k.tagged_show=fn.show;k.tagged_hide=fn.hide;fn.load_posts()})(jQuery)},mobile:function(S,C){i();var D=p("container"),B=p("message"),G=p("tumblelog_avatar"),E=p("tumblelog_title"),y=p("tumblelog_name"),M=p("device_name"),O=p("dismiss"),v=p("tumblr"),K=p("btn_open_in_app"),F=p("btn_install"),T=p("tumblr_small"),r=p("btn_open_in_app_small"),x=false;var J=a(),U,Q,I,P,L,u,s,A;var N=_t.getCookie("hide_download_app_prompt");if(N&&N.value==="1"){x=true}if(y){y.innerHTML=_t.sanitize(e.get.name,true)}if(M){M.innerHTML=_t.sanitize(J.pretty_name,true)}if(J.mobile){var H={blogName:e.get.name,page:"blog"};if(e.get.pid){H.page="permalink";H.postID=e.get.pid}var t="blog?"+_t.serialize(H);if(K){K.href=o+"/open/app?"+_t.serialize({referrer:"mobile_banner",app_args:t});K.target=""}if(F){F.href=o+"/download/"+J.name+"?"+_t.serialize({referrer:"mobile_banner",intent:t});F.target=""}if(r){r.href=o+"/open/app?"+_t.serialize({referrer:"mobile_banner_persistent",app_args:t});r.target=""}}if(v){v.href=n+"/register/join_tumblr?referring_blog="+e.get.name}if(T){T.href=n+"/register/join_tumblr?referring_blog="+e.get.name}U=parseInt(_t.getStyle(D,"margin-top"),10)||0;Q=parseInt(_t.getStyle(D,"margin-right"),10)||0;I=parseInt(_t.getStyle(D,"margin-bottom"),10)||0;P=parseInt(_t.getStyle(D,"margin-left"),10)||0;if(!I){I=6}L="100%";s=D.offsetHeight+U+I;if(!s||s<155){s=155}_t.addClass(D,"closed");u="100%";A=D.offsetHeight+U+I;if(!A||A<54){A=54}if(O){O.addEventListener("click",function(V){_t.addClass(D,"closed");_t.setCookie("hide_download_app_prompt",1,365);V.preventDefault();_t.postMessage(["mobile_resize_iframe",u,A,"margin_bottom",I,"add_iframe_class","tumblr_controls_closed","remove_iframe_class","tumblr_controls_open",_t.protocol_host()],decodeURIComponent(e.origin),window.parent);_t.postMessage(["tumblr_controls","closed",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)})}if(T){T.addEventListener("click",function(V){if(!_t.hasClass(T,"reopen_iframe")){return true}_t.removeClass(D,"closed");_t.setCookie("hide_download_app_prompt",0,365);V.preventDefault();_t.postMessage(["mobile_resize_iframe",L,s,"margin_bottom",I,"add_iframe_class","tumblr_controls_open","remove_iframe_class","tumblr_controls_closed",_t.protocol_host()],decodeURIComponent(e.origin),window.parent);_t.postMessage(["tumblr_controls","open",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)})}var R=function(V){_t.addClass(V.target,"active")};var w=function(V){_t.removeClass(V.target,"active")};if(K){K.addEventListener("touchstart",R);K.addEventListener("touchend",w);if(J.name==="android"){K.target="_blank"}}if(r){r.addEventListener("touchstart",R);r.addEventListener("touchend",w);if(J.name==="android"){r.target="_blank"}}if(F){F.addEventListener("touchstart",R);F.addEventListener("touchend",w);if(J.name==="android"){F.target="_blank"}}k.variation_callback=function(V){switch(V){case"corner_buttons":k.ready_callback(true);break;default:break}};var z;k.ready_callback=function(W){clearTimeout(z);if(C){var V=o+"/dashboard/iframe?"+decodeURIComponent(_t.serialize(e.get));if(W){V+="&mobile_corner=true"}document.location.replace(V);return}if(W){_t.addClass(D,"closed");_t.addClass(D,"corner_buttons");I=0;L=u=D.offsetWidth+P+Q;s=A=D.offsetHeight+U+I;_t.postMessage(["mobile_resize_iframe",u,A,"corner_buttons","margin_bottom",I,"add_iframe_class","tumblr_controls_closed","remove_iframe_class","tumblr_controls_open",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}else{if(!S){if(x){_t.postMessage(["mobile_resize_iframe",u,A,"margin_bottom",I,"add_iframe_class","tumblr_controls_closed","remove_iframe_class","tumblr_controls_open",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}else{_t.removeClass(D,"closed");_t.postMessage(["mobile_resize_iframe",L,s,"margin_bottom",I,"add_iframe_class","tumblr_controls_open","remove_iframe_class","tumblr_controls_closed",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}}}_t.removeClass(document.body,"loading")};_t.postMessage(["tumblr_controls",x?"closed":"open",_t.protocol_host()],decodeURIComponent(e.origin),window.parent);z=_t.delay(k.ready_callback,500)}}}());return{initialize:function(u,t){e.get=_t.getVars();e.origin=decodeURIComponent(e.get.src);m=u;if(!(m&&typeof c[m]==="function")){m="standard"}var r=_t.isLoggedIn();redirect=(!t&&!e.get.v&&(r||e.get.iphone)&&!e.get.no_redirect)||e.get.force_redirect;if(!r&&e.get.brag){window.onload=function(){f(1,1)};return false}if(!r&&!e.get.brag&&m!=="teaser"){_t.postMessage(["tagged_teaser_iframe","show",_t.protocol_host()],decodeURIComponent(e.origin),window.parent);_t.postMessage(["follow_iframe","enable",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}window.onbeforeunload=function(){if(window!==window.parent){_t.postMessage(["location_change",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}};if(redirect&&m!=="mobile"){document.location.replace(o+"/dashboard/iframe?"+decodeURIComponent(_t.serialize(e.get)));return}Tumblr.PostMessageListener.initialize(function(v){Tumblr.Iframe.post_message_event(v)});var s=["standard","pill","b_card","o_pill","mobile"];if(Tumblr.LikeButtonRequests&&s.indexOf(u)>=0){Tumblr.PostMessageListener.initialize(function(w,v){Tumblr.LikeButtonRequests.get_like_states(w);Tumblr.LikeButtonRequests.send_like(w,v);Tumblr.LikeButtonRequests.send_unlike(w,v)});Tumblr.LikeButtonRequests.loaded()}window.onload=function(){g=(window.navigator.userLanguage||window.navigator.language||"en_US").toLowerCase();g=(window.l10n_keys&&window.l10n_keys[g])?window.l10n_keys[g]:g;g=g.toLowerCase().replace("_","-");j=window.l10n_str[g]||window.l10n_str["en-us"];q(j,false);_t.addClass(document.body,"version_"+m);c[m](r,redirect);if(r&&Tumblr.IframeButtons){Tumblr.IframeButtons.init()}};if(window!==window.parent){_t.postMessage(["request_keywords",_t.protocol_host()],decodeURIComponent(e.origin),window.parent)}},post_message_event:function(r){if(r[0]==="parent_scroll"){if(typeof k.scroll_callback==="function"){k.scroll_callback(r[1],r[2],r[3],r[4])}}if(r[0]==="follow_teaser"){if(typeof k.follow_show==="function"){if(r.length>1&&r[1]==="show"){k.follow_show()}}}if(r[0]==="set_variation"){if(typeof k.variation_callback==="function"){k.variation_callback(r[1])}}if(r[0]==="teaser"){if(r.length<2){return}switch(r[1]){case"enable":k.teaser=true;return;case"disable":k.teaser=false;return;case"refresh":if(typeof k.teaser_refresh==="function"){k.teaser_refresh()}return;case"show":if(typeof k.teaser_show==="function"){k.teaser_show()}return;case"hide":if(typeof k.teaser_hide==="function"){k.teaser_hide()}return;case"prepare_next":if(typeof k.teaser_hide==="function"){k.teaser_hide()}if(typeof k.teaser_refresh==="function"){k.teaser_refresh()}return}}}}})();(function(c,a){if(!c){return}var d={init:function(g){var e=c(".btn:not(.hidden)"),f=0;e.each(function(){var h=c(this);f+=h.outerWidth(true)});if(c(".btn.unfollow.hidden").length){f+=15}if(typeof(g)=="function"){g(f)}}};a.IframeSizing=d;var b={init:function(){c(".iframe_controls").on("click",".btn.reblog",function(i){var h=c(this),e=i.shiftKey,j=h.attr("data-form-key"),f=h.attr("data-reblog-key"),k=h.attr("data-reblog-id");if(i.altKey){if(!f.length){h.addClass("animated shake");window.setTimeout(function(){h.removeClass("shake")},1000);return false}if(!h.hasClass("reblogged")){h.addClass("reblogged");h.addClass("animated").addClass("poof");window.setTimeout(function(){h.addClass("final_state")},1000);var g=c.ajax({url:"/fast_reblog",type:"POST",data:{form_key:j,reblog_key:f,reblog_post_id:k,queue:e}});g.error(function(){h.removeClass("reblogged");alert(l10n_str.ajax_error)})}return false}});c(".iframe_controls").on("click",".btn.follow, .btn.unfollow, .btn.like, .btn.unlike",function(g){g.stopPropagation();g.preventDefault();var f=c(this),e=false,h={};f.addClass("hidden");if(f.hasClass("follow")){e=Tumblr.follow;h={tumblelog:f.attr("data-tumblelog-name"),source:"FOLLOW_SOURCE_IFRAME"};f.siblings(".unfollow").removeClass("hidden")}if(f.hasClass("unfollow")){e=Tumblr.unfollow;h={tumblelog:f.attr("data-tumblelog-name"),source:"UNFOLLOW_SOURCE_IFRAME"};f.siblings(".follow").removeClass("hidden")}if(f.hasClass("like")){e=Tumblr.like;h={id:f.attr("data-id"),key:f.attr("data-key"),source:"LIKE_SOURCE_IFRAME"};f.siblings(".unlike").removeClass("hidden")}if(f.hasClass("unlike")){e=Tumblr.unlike;h={id:f.attr("data-id"),key:f.attr("data-key"),source:"UNLIKE_SOURCE_IFRAME"};f.siblings(".like").removeClass("hidden")}if(e){e(h,{success:function(){},error:function(){alert(l10n_str.ajax_error)}})}})}};a.IframeButtons=b})(jQuery,Tumblr);
Tumblr.LikeButtonRequests={loaded:function(){Tumblr.LikeButtonRequests.post_to_parent({},"logged_in_iframe_loaded")},get_like_states:function(b){if(b[0]==="get_like_states"){if(typeof jQuery==="undefined"||!jQuery){return}var a=jQuery("#tumblelog_name").data("tumblelog-name");var e=JSON.parse(b[1]);var d=jQuery("#tumblr_form_key").attr("content");var c={form_key:d,tumblelog_name:a};if(e){if(e.page){c.page=e.page}if(e.ids){c.ids=e.ids}}jQuery.ajax({url:"/svc/like_state",type:"post",data:c,success:function(f){Tumblr.LikeButtonRequests.post_to_parent(f)}})}},send_like:function(c,a){if(a!=="http://assets.tumblr.com"){return}if(c[0]==="like"){var d=JSON.parse(c[1]);var b=d.post_id;var e=d.reblog_key;if(b&&e){d={id:b,key:e,source:"LIKE_SOURCE_TUMBLELOG_INLINE"};Tumblr.like(d,{success:function(){var f={post_id:b,state:true};Tumblr.LikeButtonRequests.post_to_parent(f)},error:function(){alert(l10n_str.ajax_error)}})}}},send_unlike:function(c,a){if(a!=="http://assets.tumblr.com"){return}if(c[0]==="unlike"){var d=JSON.parse(c[1]);var b=d.post_id;var e=d.reblog_key;if(b&&e){d={id:b,key:e,source:"UNLIKE_SOURCE_TUMBLELOG_INLINE"};Tumblr.unlike(d,{success:function(){var f={post_id:b,state:false};Tumblr.LikeButtonRequests.post_to_parent(f)},error:function(){alert(l10n_str.ajax_error)}})}}},post_to_parent:function(b,a){if(!a){a="like_state_update"}var d=a+";"+JSON.stringify(b);try{window.parent.postMessage(d,"*")}catch(c){}}};
(function(e,d){if(e.addEventListener){return}function a(g){var f=d[g];d[g]=function(h){return b(f(h))}}function c(f,h,g){return(g=this).attachEvent("on"+f,function(i){i=i||e.event;i.preventDefault=i.preventDefault||function(){i.returnValue=false};i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=true};h.call(g,i)})}function b(g,f){if(f=g.length){while(f--){g[f].addEventListener=c}}else{g.addEventListener=c}return g}b([d,e]);if("Element" in e){e.Element.prototype.addEventListener=c}else{d.attachEvent("onreadystatechange",function(){b(d.all)});a("getElementsByTagName");a("getElementById");a("createElement");b(d.all)}})(window,document);
var _t=(function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,e){if(this===null){throw new TypeError()}var d=this;var a=d.length>>>0;if(a===0){return -1}var f=0;if(arguments.length>1){f=Number(arguments[1]);if(f!=f){f=0}else{if(f!==0&&f!=Infinity&&f!=-Infinity){f=(f>0||-1)*Math.floor(Math.abs(f))}}}if(f>=a){return -1}var b=f>=0?f:Math.max(a-Math.abs(f),0);for(;b<a;b++){if(b in d&&d[b]===c){return b}}return -1}}return{isLoggedIn:function(){return(document.cookie.indexOf("logged_in=1")!=-1)},sanitize:function(a,b){if(b){a=decodeURIComponent(a)}return a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},getVars:function(){var a={};window.location.hash.replace(/[#?&]+([^=&]+)(=[^&]*)?/gi,function(b,c,d){a[c]=(d===undefined)?true:d.substring(1);if(a[c].indexOf("/")!==-1){a[c]=encodeURIComponent(a[c])}});window.location.search.replace(/[?&]+([^=&]+)(=[^&]*)?/gi,function(b,c,d){a[c]=(d===undefined)?true:d.substring(1)});return a},objSize:function(b){var a=0,c;for(c in b){if(b.hasOwnProperty(c)){a++}}return a},randomProperty:function(c){var a,b=0,d;for(d in c){if(Math.random()<1/b++){a=d}}return a},findParent:function(c,b){var a=c.parentNode;while(!_t.matchesSelector(a,b)){if(!a.parentNode){return false}a=a.parentNode}return a},containsElement:function(c,d,b){if(!c||!d){return false}if(!b&&c===d){return false}var a=d;do{if(c===a){return true}}while((a=a.parentNode));return false},matchesSelector:function(c,a){if(!c){return false}if(c.webkitMatchesSelector){return c.webkitMatchesSelector(a)}if(c.mozMatchesSelector){return c.mozMatchesSelector(a)}var b=document.querySelectorAll(a);for(var d in b){return b[d]===c}return false},addClass:function(a,b){if((" "+a.className+" ").indexOf(" "+b+" ")==-1){a.className=a.className===""?b:a.className+" "+b}},removeClass:function(b,a){if(b.className.indexOf(a)==-1){return}var c=b.className.split(" ");c.splice(c.indexOf(a),1);b.className=c.join(" ")},addClasses:function(c,b){for(var a=0;a<b.length;a++){_t.addClass(c,b[a])}},removeClasses:function(c,b){for(var a=0;a<b.length;a++){_t.removeClass(c,b[a])}},toggleClass:function(b,a){if(hasClass(b,a)){_t.removeClass(b,a)}else{_t.addClass(b,a)}},hasClass:function(b,a){if(!b){return}var c=b.className;return(c.split(" ").indexOf(a)!==-1)},serialize:function(e,c){var f=[];for(var d in e){var b=c?c+"["+d+"]":d,a=e[d];f.push(typeof a=="object"?serialize(a,b):encodeURIComponent(b)+"="+encodeURIComponent(a))}return f.join("&")},relativeDate:function(b){var a=new Date();if(b){a.setTime(a.getTime()+b)}return a},getRootDomain:function(b,a){if(!b){b=document.location.href}var c=b.replace(/^[^\/]+\/\/([^\/]+).*/i,"$1");var e=c.split(".");if(e.length<2){return c}var d=e.slice(a?1:-2).join(".");if(d.toLowerCase()==="tumblr.net"){return c}return d},getCookie:function(d){var b=document.cookie;var g,f=b.split(";");var e,a=f.length;for(e=0;e<a;e+=1){if((g=f[e].replace(/^\s+|\s+$/g,"").split("="))[0]==d){return{name:g[0],value:g[1]}}}return false},setCookie:function(a,f,h,c){c=c||{};var b=new Date();var g=(typeof(c.path)!=="undefined")?c.path:"/";var e=(typeof(c.is_secure)!=="undefined")?true:false;var d=(typeof(c.domain)!=="undefined")?c.domain:"";b.setDate(b.getDate()+h);if(typeof(c.expire_date)!=="undefined"){expire_dates=true;b=c.expire_date}document.cookie=a+"="+escape(f)+((h===null)?"":";expires="+b.toGMTString())+";path="+g+((e===false)?"":";secure")+((d==="")?"":";domain="+d)},unsetCookie:function(a){_t.setCookie(a,"",-1)},getStyle:function(c,a){if(!c){return false}var b;if(typeof c.currentStyle!="undefined"){b=c.currentStyle}else{b=document.defaultView.getComputedStyle(c,null)}return b[a]||false},sortObj:function(e,d){var f=[];for(var c in e){if(e.hasOwnProperty(c)){f.push(c)}}if(typeof d==="function"){f.sort(d)}else{if(d==="value"){f.sort(function(i,h){var g=e[i];var j=e[h];return((g<j)?-1:((g>j)?1:0))})}else{f.sort()}}var a={};for(var b=0;b<f.length;b++){a[f[b]]=e[f[b]]}return a},reverseObj:function(e){var f=[];var c={};for(var d in e){var b={};b.key=d;b.val=e[d];f.push(b)}f.reverse();for(var a in f){c[f[a].key]=f[a].val}return c},protocol_host:function(){return document.location.protocol+"//"+document.location.host},postMessage:function(c,a,b){if(!b){b=parent}if(typeof c!=="string"){c=c.join(";")}if(b!==window){b.postMessage(c,a)}},each:function(c,b){for(var a=0;a<c.length;a++){if(b.apply(this,[a,c[a]])===false){return}}},trim:function(a){return a.replace(/\s*(.*\S)?\s*/i,"$1")},delay:function(d,c,a,b){if(!a){a=this}if(!b){b=[]}if(c<0){d.apply(a,b);return false}return setTimeout(function(){d.apply(a,b)},c)},is_mobile:function(b){if(typeof b==="undefined"){b=(navigator.userAgent||navigator.vendor||window.opera)}return !!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))}}})();
